import unittest
import collaborative_filtering_for_movies as cf


class MyTestCase(unittest.TestCase):
    def test_1(self):
        all_list = [
            306,
            665,
            1,
            150,
            151,
            236,
            260,
            333,
            356,
            524,
            527,
            534,
            588,
            858,
            953,
            29,
            50,
            173,
            214,
            293,
            296,
            318,
            480,
            589,
            741,
            780,
            913,
            924,
            19,
            32,
            39,
            47,
            88,
            95,
            122,
            141,
            147,
            191,
            219,
            231,
            238,
            253,
            277,
            288,
            337,
            344,
            364,
            435,
            457,
            477,
            487,
            542,
            553,
            590,
            593,
            595,
            608,
            784,
            161,
            902,
            28,
            165,
            232,
            307,
            7,
            10,
            18,
            25,
            27,
            62,
            104,
            163,
            180,
            198,
            207,
            209,
            223,
            225,
            316,
            325,
            428,
            442,
            490,
            551,
            575,
            628,
            648,
            733,
            785,
            799,
            875,
            904,
            923,
            105,
            158,
            168,
            273,
            276,
            329,
            355,
            361,
            370,
            380,
            387,
            410,
            420,
            432,
            434,
            455,
            464,
            474,
            500,
            519,
            520,
            539,
            540,
            541,
            585,
            586,
            592,
            597,
            616,
            805,
            919,
            934,
            938,
            971,
            193,
            2,
            3,
            16,
            21,
            22,
            31,
            45,
            48,
            68,
            140,
            176,
            185,
            186,
            203,
            215,
            222,
            249,
            252,
            265,
            292,
            319,
            343,
            351,
            433,
            440,
            450,
            466,
            489,
            497,
            508,
            514,
            515,
            518,
            528,
            538,
            543,
            555,
            594,
            603,
            708,
            745,
            765,
            778,
            832,
            880,
            898,
            908,
            910,
            911,
            60,
            70,
            110,
            112,
            153,
            216,
            367,
            377,
            349,
            5,
            11,
            17,
            266,
            123,
            718,
            44,
            317,
            339,
            14,
            36,
            40,
            111,
            194,
            261,
            281,
            300,
            348,
            357,
            441,
            452,
            456,
            492,
            506,
            511,
            529,
            535,
            800,
            848,
            851,
            159,
            196,
            208,
            235,
            247,
            384,
            431,
            933,
            940,
            941,
            969,
            610,
            671,
            69,
            413,
            145,
            345,
            454,
            587,
            736,
            909,
            932,
            34,
            493,
            737,
            144,
            160,
            164,
            224,
            243,
            262,
            272,
            314,
            494,
            596,
            647,
            698,
            715,
            753,
            801,
            852,
            481,
            368,
            465,
            552,
            798,
            886,
            427,
            58,
            507,
            720,
            724,
            750,
            838,
            866,
            914,
            83,
            650,
            719,
            728,
            761,
            766,
            802,
            837,
            849,
            903,
            912,
            954,
            30,
            35,
            94,
            162,
            246,
            326,
            342,
            509,
            613,
            786,
            256,
            73,
            668,
            97,
            663,
            899,
            965,
            230,
            350,
            471,
            653,
            928,
            968,
            327,
            372,
            627,
            915,
            916,
            955,
            661,
            366,
            546,
            558,
            673,
            692,
            76,
            81,
            100,
            118,
            157,
            305,
            322,
            353,
            354,
            505,
            531,
            537,
            550,
            635,
            674,
            881,
            937,
            942,
            943,
            61,
            640,
            762,
            6,
            362,
            376,
            303,
            313,
            175,
            42,
            170,
            328,
            358,
            424,
            436,
            473,
            532,
            611,
            662,
            694,
            695,
            782,
            788,
            839,
            891,
            74,
            195,
            237,
            378,
            700,
            946,
            85,
            605,
            905,
            926,
            930,
            172,
            78,
            213,
            290,
            707,
            475,
            900,
            952,
            383,
            92,
            626,
            233,
            294,
            297,
            308,
            446,
            570,
            994,
            999,
            714,
            922,
            99,
            52,
            155,
            352,
            371,
            581,
            748,
            781,
            986,
            363,
            423,
            517,
            998,
            116,
            242,
            302,
            521,
            65,
            107,
            174,
            267,
            312,
            374,
            609,
            637,
            747,
            64,
            79,
            103,
            113,
            135,
            920,
            218,
            271,
            340,
            9,
            227,
            132,
            181,
            248,
            289,
            491,
            688,
            783,
            502,
            556,
            735,
            93,
            691,
            188,
            393,
            485,
            239,
            917,
            282,
            315,
            43,
            204,
            257,
            360,
            381,
            415,
            451,
            459,
            804,
            830,
            906,
            945,
            948,
            949,
            982,
            41,
            46,
            901,
            101,
            125,
            670,
            310,
            4,
            408,
            562,
            710,
            379,
            405,
            544,
            548,
            836,
            996,
            26,
            171,
            229,
            332,
            412,
            407,
            13,
            63,
            678,
            742,
            234,
            82,
            121,
            388,
            828,
            12,
            634,
            656,
            743,
            23,
            338,
            533,
            606,
            80,
            190,
            334,
            659,
            697,
            907,
            37,
            346,
            24,
            169,
            892,
            382,
            760,
            280,
            482,
            818,
            829,
            860,
            72,
            152,
            156,
            373,
            417,
            561,
            20,
            66,
            86,
            241,
            279,
            359,
            416,
            419,
            422,
            448,
            516,
            554,
            809,
            842,
            202,
            89,
            274,
            612,
            810,
            861,
            547,
            263,
            879,
            501,
            869,
            921,
            950,
            951,
            835,
            468,
            549,
            824,
            571,
            727,
            680,
            347,
            731,
            391,
            479,
            991,
            536,
            258,
            437,
            990,
            639,
            882,
            444,
            631,
            711,
            615,
            512,
            102,
            183,
            426,
            177,
            179,
            220,
            498,
            764,
            893,
            987,
            210,
            270,
            469,
            124,
            618,
            664,
            713,
            844,
            984,
            55,
            117,
            149,
            574,
            617,
            679,
            841,
            598,
            8,
            15,
            87,
            709,
            324,
            927,
            449,
            504,
            154,
            299,
            681,
            115,
            619,
            569,
            57,
            897,
            51,
            56,
            623,
            199,
            833,
            599,
            189,
            228,
            71,
            129,
            217,
            259,
            438,
            458,
            522,
            564,
            568,
            295,
            667,
            429,
            840,
            484,
            918,
            638,
            867,
            460,
            472,
            499,
            126,
            807,
            755,
            146,
            421,
            960,
            961,
            976,
            808,
            463,
            445,
            806,
            580,
            936,
            757,
            602,
            268,
            988,
            205,
            704,
            973,
            254,
            255,
            330,
            970,
            166,
            212,
            386,
            486,
            365,
            461,
            565,
            682,
            321,
            563,
            96,
            335,
            483,
            649,
            846,
            947,
            935,
            964,
            211,
            685,
            779,
            523,
            931,
            1000,
            138,
            245,
            390,
            746,
            850,
            401,
            453,
            470,
            862,
            467,
            304,
            75,
            853,
            865,
            873,
            876,
            877,
            878,
            178,
            298,
            767,
            577,
            425,
            206,
            278,
            287,
            301,
            369,
            997,
            447,
            187,
            394,
            703,
            275,
            725,
            90,
            137,
            402,
            582,
            633,
            705,
            732,
            790,
            791,
            793,
            795,
            827,
            834,
            847,
            855,
            856,
            871,
            895,
            896,
            992
        ]

        one_list = [
            2,
            3,
            7,
            10,
            20,
            21,
            22,
            23,
            32,
            36,
            39,
            45,
            47,
            48,
            50,
            61,
            66,
            74,
            78,
            86,
            95,
            100,
            111,
            141,
            145,
            150,
            160,
            168,
            170,
            173,
            186,
            203,
            204,
            208,
            218,
            225,
            241,
            252,
            257,
            267,
            276,
            277,
            279,
            303,
            315,
            329,
            333,
            337,
            338,
            339,
            340,
            350,
            355,
            356,
            359,
            362,
            364,
            367,
            370,
            373,
            376,
            380,
            383,
            416,
            419,
            420,
            422,
            428,
            434,
            435,
            440,
            442,
            448,
            454,
            455,
            471,
            474,
            485,
            489,
            497,
            500,
            502,
            508,
            516,
            527,
            528,
            540,
            542,
            544,
            548,
            551,
            552,
            553,
            554,
            585,
            586,
            587,
            588,
            589,
            593,
            595,
            605,
            613,
            626,
            640,
            653,
            662,
            694,
            707,
            708,
            719,
            733,
            748,
            750,
            762,
            781,
            784,
            785,
            786,
            788,
            799,
            802,
            805,
            809,
            818,
            839,
            842,
            849,
            858,
            881,
            886,
            891,
            908,
            910,
            912,
            913,
            915,
            933,
            934,
            954
        ]
        list_r = cf.recommend(230, '1995-01-09 00:00:00', '2019-11-21 00:00:00', 0.8,
                              './similarity_data/20230518-145819.csv', 'test1')
        list_r = list(set(list_r) & set(all_list))
        print(list_r)
        res = 1.0 * (len(set(list_r)) - len(set(list_r).difference(
            set(one_list)))) / len(set(list_r))
        print(res)

    def test_2(self):
        all_list = [
            296,
            306,
            307,
            665,
            899,
            1,
            150,
            151,
            236,
            260,
            261,
            266,
            318,
            380,
            480,
            497,
            534,
            553,
            588,
            589,
            914,
            953,
            32,
            50,
            111,
            293,
            442,
            593,
            741,
            778,
            780,
            858,
            912,
            541,
            47,
            88,
            104,
            113,
            122,
            147,
            153,
            216,
            218,
            219,
            224,
            231,
            267,
            312,
            333,
            337,
            344,
            364,
            372,
            432,
            440,
            477,
            491,
            542,
            592,
            608,
            628,
            671,
            784,
            902,
            919,
            28,
            58,
            165,
            185,
            232,
            288,
            329,
            410,
            527,
            11,
            18,
            21,
            39,
            62,
            69,
            95,
            161,
            198,
            201,
            209,
            223,
            225,
            290,
            292,
            325,
            356,
            428,
            457,
            474,
            490,
            494,
            551,
            575,
            648,
            750,
            799,
            805,
            903,
            904,
            10,
            61,
            168,
            256,
            273,
            317,
            361,
            362,
            366,
            420,
            434,
            445,
            454,
            455,
            500,
            516,
            587,
            590,
            594,
            596,
            616,
            667,
            818,
            852,
            920,
            924,
            934,
            938,
            943,
            952,
            954,
            971,
            110,
            193,
            3,
            7,
            16,
            20,
            22,
            27,
            140,
            141,
            160,
            175,
            203,
            215,
            253,
            268,
            313,
            319,
            342,
            343,
            374,
            377,
            441,
            450,
            471,
            505,
            514,
            531,
            562,
            585,
            586,
            603,
            605,
            627,
            663,
            724,
            736,
            745,
            851,
            908,
            923,
            932,
            34,
            70,
            112,
            173,
            277,
            303,
            520,
            595,
            349,
            5,
            357,
            367,
            802,
            44,
            123,
            158,
            718,
            783,
            968,
            539,
            316,
            6,
            14,
            40,
            52,
            105,
            186,
            281,
            369,
            370,
            413,
            466,
            508,
            529,
            538,
            543,
            597,
            708,
            733,
            800,
            848,
            915,
            994,
            31,
            17,
            25,
            159,
            196,
            208,
            235,
            247,
            252,
            280,
            282,
            315,
            339,
            350,
            384,
            431,
            524,
            535,
            555,
            933,
            941,
            73,
            36,
            300,
            345,
            412,
            647,
            926,
            969,
            19,
            376,
            46,
            207,
            222,
            243,
            265,
            272,
            452,
            468,
            509,
            609,
            715,
            753,
            801,
            808,
            97,
            162,
            910,
            383,
            481,
            163,
            170,
            368,
            465,
            511,
            552,
            610,
            786,
            861,
            940,
            427,
            2,
            507,
            838,
            82,
            83,
            631,
            650,
            656,
            761,
            766,
            781,
            809,
            762,
            911,
            913,
            955,
            30,
            35,
            144,
            205,
            326,
            448,
            475,
            501,
            515,
            145,
            668,
            101,
            180,
            435,
            24,
            29,
            230,
            720,
            832,
            928,
            258,
            351,
            444,
            489,
            548,
            916,
            48,
            653,
            694,
            737,
            788,
            849,
            891,
            866,
            76,
            81,
            118,
            157,
            182,
            195,
            276,
            322,
            354,
            407,
            436,
            451,
            506,
            518,
            537,
            540,
            544,
            550,
            569,
            599,
            606,
            635,
            674,
            707,
            785,
            830,
            880,
            881,
            898,
            905,
            937,
            942,
            949,
            967,
            984,
            996,
            86,
            837,
            60,
            355,
            421,
            661,
            172,
            23,
            332,
            371,
            382,
            393,
            464,
            493,
            512,
            532,
            611,
            695,
            782,
            850,
            263,
            314,
            700,
            74,
            613,
            353,
            930,
            675,
            26,
            78,
            85,
            213,
            640,
            765,
            348,
            900,
            965,
            92,
            100,
            102,
            132,
            249,
            297,
            308,
            446,
            164,
            892,
            999,
            922,
            443,
            194,
            363,
            549,
            581,
            951,
            246,
            950,
            42,
            405,
            748,
            45,
            103,
            121,
            237,
            242,
            302,
            63,
            107,
            135,
            414,
            473,
            637,
            709,
            747,
            833,
            875,
            75,
            836,
            271,
            340,
            9,
            227,
            381,
            502,
            94,
            125,
            176,
            206,
            93,
            688,
            188,
            418,
            239,
            262,
            181,
            257,
            360,
            453,
            459,
            906,
            918,
            944,
            41,
            57,
            79,
            199,
            901,
            517,
            714,
            310,
            65,
            408,
            710,
            379,
            387,
            485,
            504,
            692,
            798,
            886,
            998,
            154,
            171,
            299,
            719,
            13,
            673,
            678,
            234,
            43,
            388,
            12,
            840,
            204,
            338,
            419,
            460,
            533,
            117,
            155,
            334,
            492,
            519,
            662,
            725,
            907,
            33,
            37,
            346,
            829,
            279,
            191,
            240,
            456,
            482,
            547,
            574,
            742,
            948,
            72,
            214,
            152,
            378,
            392,
            417,
            561,
            612,
            250,
            289,
            415,
            416,
            422,
            433,
            484,
            704,
            835,
            839,
            921,
            931,
            169,
            202,
            4,
            15,
            89,
            259,
            274,
            358,
            743,
            917,
            305,
            726,
            879,
            365,
            373,
            860,
            536,
            177,
            936,
            946,
            554,
            556,
            909,
            347,
            828,
            391,
            479,
            166,
            842,
            423,
            463,
            156,
            804,
            882,
            522,
            229,
            526,
            735,
            945,
            64,
            810,
            615,
            760,
            885,
            183,
            328,
            330,
            426,
            711,
            546,
            179,
            187,
            295,
            498,
            499,
            566,
            570,
            691,
            764,
            987,
            210,
            327,
            697,
            55,
            618,
            639,
            685,
            844,
            90,
            124,
            341,
            728,
            841,
            598,
            106,
            988,
            190,
            87,
            248,
            437,
            324,
            438,
            449,
            521,
            116,
            681,
            68,
            115,
            264,
            389,
            174,
            523,
            897,
            245,
            558,
            99,
            56,
            233,
            991,
            947,
            626,
            336,
            963,
            189,
            228,
            309,
            129,
            731,
            352,
            568,
            824,
            986,
            893,
            38,
            472,
            429,
            666,
            8,
            359,
            960,
            961,
            467,
            66,
            634,
            525,
            680,
            806,
            580,
            959,
            602,
            869,
            935,
            254,
            927,
            755,
            71,
            126,
            486,
            447,
            251,
            287,
            149,
            682,
            321,
            563,
            96,
            528,
            929,
            577,
            386,
            458,
            976,
            211,
            565,
            241,
            425,
            1000,
            80,
            390,
            746,
            970,
            401,
            487,
            619,
            217,
            470,
            375,
            119,
            981,
            212,
            294,
            823,
            843,
            855,
            856,
            865,
            867,
            870,
            876,
            877,
            983,
            298,
            751,
            146,
            238,
            301,
            469,
            148,
            54,
            304,
            394,
            478,
            638,
            703,
            283,
            67,
            614,
            617,
            633,
            705,
            713,
            791,
            795,
            797,
            834,
            845,
            853,
            871,
            896,
            979,
            993
        ]

        r_list = cf.recommend(396, '1995-01-09 00:00:00', '2019-11-21 00:00:00', 0.8,
                              './similarity_data/20230518-175915.csv', 'test1')
        re_list = [
            1,
            3,
            7,
            11,
            12,
            15,
            16,
            25,
            29,
            32,
            34,
            36,
            39,
            46,
            47,
            48,
            50,
            57,
            64,
            70,
            72,
            74,
            81,
            93,
            97,
            101,
            105,
            110,
            111,
            118,
            121,
            122,
            151,
            163,
            164,
            168,
            176,
            177,
            179,
            183,
            187,
            188,
            194,
            195,
            207,
            215,
            220,
            222,
            223,
            224,
            233,
            235,
            236,
            237,
            239,
            246,
            247,
            249,
            252,
            253,
            258,
            266,
            268,
            273,
            276,
            289,
            293,
            295,
            296,
            306,
            318,
            319,
            322,
            328,
            330,
            332,
            339,
            348,
            353,
            356,
            357,
            361,
            362,
            366,
            377,
            380,
            382,
            388,
            407,
            417,
            426,
            431,
            440,
            444,
            451,
            457,
            471,
            475,
            493,
            498,
            499,
            501,
            509,
            529,
            532,
            538,
            539,
            543,
            550,
            551,
            553,
            555,
            566,
            570,
            587,
            589,
            593,
            597,
            605,
            606,
            608,
            611,
            647,
            691,
            697,
            707,
            708,
            724,
            735,
            742,
            764,
            778,
            779,
            788,
            799,
            800,
            802,
            804,
            805,
            842,
            852,
            861,
            866,
            875,
            879,
            891,
            893,
            987,
            988
        ]

        r_list = list(set(r_list) & set(all_list))

        print(r_list)
        acc = 1.0 * (len(set(r_list)) - len(set(r_list).difference(
            set(re_list)))) / len(set(r_list))
        print(acc)


if __name__ == '__main__':
    unittest.main()
